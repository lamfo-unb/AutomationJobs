---
output:
  html_document:
      css: style.css
bibliography: bibliography.bib
csl: apa.csl
lang: pt
link-citations: true
# nocite: "@*"
---

<div class="center">

<img src="Logo2.png" style="float: left; width: 30%;height: auto;" hspace="20px;">
<div class="title2">
  <p class="title">Laboratório de Aprendizado de Máquina em Finanças e Organizações</p>
  <p class="alignright"> <a href="http://lamfo.unb.br/">http://lamfo.unb.br </a> </p>
</div>


<p class="main">
Automação e eliminação de postos de trabalho na era da automação
</p>


<div class="row">
<div class="column">
<h2>Pedro Albuquerque</h2>
<p>Universidade de Brasília</p>
</div>
<div class="column">
<h2>Cayan Portela</h2>
<p>Universidade de Brasília</p>
</div>
<div class="column">
<h2>Rafael Morais</h2>
<p>Universidade de Brasília</p>
</div>
<div class="column">
<h2>Patrick Alves</h2>
<p>Instituto de Pesquisa Econômica Aplicada</p>
</div>
</div>

<div class="abstract">
<p style="text-align: center;font-weight: bold;font-size: 25px;"> Resumo </p>
<p style="width: 80%;position: relative;right: -10%;">
The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.The abstract of the article.
</p>
<i> Palavras-chave:</i> keywords, comma-separated, not capitalized, Java.
</div>


```{r setup, include=FALSE}
library(knitr)
# library(kableExtra)
library(tidyverse)
library(plotly)
library(readxl)
library(pdftools)

opts_chunk$set(message=FALSE, warning=FALSE, comment=NA, echo=FALSE, out.width='100%', out.height='auto', fig.align='center', cache=T)

# opts_knit$set(root.dir = "C:\\Users\\Pedro Albuquerque\\Desktop\\AutomationJobs")
opts_knit$set(root.dir = "C:/Users/B2657804/Google Drive/LAMFO/AutomationJobs")

# A function for captioning and referencing images
fig <- local({
    i <- 0
    ref <- list()
    list(
        cap=function(refName, text) {
            i <<- i + 1
            ref[[refName]] <<- i
            paste("Figura ", i, ": ", text, sep="")
        },
        ref=function(refName) {
            ref[[refName]]
        })
})
```


<center style="padding-top:55px">
## 1. Introdução 
</center>

O ambiente gerencial tem sofrido mudanças drásticas em sua estrutura funcional devido à inserção de novas tecnologias nas organizações. Algoritmos e automação por meio do Aprendizado de Máquina tornaram-se cada vez mais comuns, principalmente devido à competição entre as firmas por aumentar a produção e reduzir custos.

Nesse sentido, os gestores precisam estar cientes dessas novas tecnologias e de como suas organizações podem se beneficiar da implementação desses sistemas. Consequentemente, uma mudança no paradigma de negócios e na maneira pela qual a contratação de funcionários, ou a substituição destes por máquinas, é o objeto de estudo deste trabalho.

A automação tornou-se o maior receio das pessoas empregadas nos últimos anos, tanto nos países desenvolvidos quanto nos subdesenvolvidos. Há uma preocupação extensa hoje em dia de que as tecnologias oriundas do Aprendizado de Máquina criem desemprego em massa durante os próximos anos.

Por exemplo, em março de 2018, os funcionários da Empresa Brasileira de Correios e Telégrafos declararam greve. Uma das demandas dos grevistas foi o retorno de um cargo eliminado pela gerência do órgão, o qual era responsável por selecionar e verificar manualmente cada pacote/carta e depois separar esses pacotes segundo o destino [@Cavallini2018]. Essa demanda foi motivada após os ocupantes desses cargos terem sido demitidos ou realocados em outras tarefas após a automatização no processo de produção dos Correios. A era da automação do Brasil se alinha com os achados de @david2015there, sobre a perfeita substituibilidade entre o desempenho humano em nível mediano e a tecnologia atualmente disponível.

Outra situação semelhante que poderia ser evitada com a automação foi a greve dos caminhoneiros 2018 do Brasil. Essa paralisação nacional de estradas causou uma escassez de alimentos, medicamentos e petróleo em todo o Brasil, com longas filas de veículos para postos de gasolina [@bloomberg].

Além disso, o grande e pesado governo brasileiro, com sua cultura de paternalismo e ineficiência do @worldbank2017, está se tornando uma grande oportunidade para a substituição de muitos trabalhos manuais rotineiros realizados no setor público @david2015there. Dessa forma, é natural o surgimento de resistência contra o uso de máquinas de sindicatos e associações.

Para monitorar essa recente mudança de paradigma no mercado de trabalho dos EUA @dvorkin2016jobs apresentou a evolução de quatro tipos de trabalhos: manual rotineiro; manual não rotineiro; cognitivo rotineiro; cognitivo não rotineiro. Em seu artigo @dvorkin2016jobs mostra que o número de empregos rotineiros manuais e rotineiros cognitivos não está crescendo tão rápido quanto possível, e uma explicação para isso é o nível de automação que está aumentando nos últimos anos. Essa diferença entre os quatro tipos de empregos pode produzir, em um futuro próximo, mais desigualdade e desemprego no Brasil se nenhuma política pública for tomada.

Uma questão que é continuamente investigada é se as novas tecnologias são realmente responsáveis por uma década de baixo crescimento de empregos no Brasil e no mundo. Segundo @rotman2013technology, muitos economistas alegam que os resultados produzidos nos últimos anos são inconclusivos, pois há várias outras explicações plausíveis, como crises financeiras, por exemplo.

Por outro lado, @frey2017future, postulam que todas as ocupações, em vez de
tarefas únicas, são automatizadas por avanços tecnológicos. Em seu artigo, eles descobriram que 47% de todos os empregos nos EUA podem estar em risco de serem automatizados em um futuro próximo. Seu ponto de vista foi mais pessimista do que outros autores, entretanto, é o artigo mais citado sobre o tema na atualidade.

Os autores focaram nos avanços tecnológicos no que eles chamam de Aprendizado de Máquina - AM. Sua suposição é que essa era organizacional na qual vivemos é diferente de outras revoluções tecnológicas, isso porque agora as máquinas são capazes de realizar tarefas que até recentemente eram consideradas genuinamente humanas, como tarefas manuais rotineiras, bem como as não-rotineiras.

@brynjolfsson2014second estão de acordo com @frey2017future. Eles sugerem que, devido à automação de algumas tarefas cognitivas rotineiras, as novas tecnologias podem cada vez mais, servir de substitutos e não apenas de complemento aos trabalhadores que realizam essas tarefas.

No paradigma otimista @alexopoulos2016medium, por exemplo, afirmam que os choques tecnológicos historicamente positivos aumentaram as oportunidades de emprego. Dessa forma, a automação poderia, a longo prazo, ser boa para toda a economia.

Além disso, os métodos de AM são tão bons quanto sua amostra de treinamento e devem considerar grandes conjuntos de dados com milhares de exemplos disponíveis para que a qualidade da máquina desenvolvida seja suficientemente boa. A qualidade dos dados na maioria das empresas dos países subdesenvolvidos é muito baixa, ou ainda, essas firmas não registram seus dados. Isto torna impossível automatizar as tarefas, visto que não há dados e quando há estes estão muito ruins.

Baseado nesse cenário, este estudo contribui para a literatura internacional sobre automação e emprego, estudando a evolução do número de postos de trabalho no Brasil ao longo do tempo e espaço relacionados com o grau de automação, utilizando para isso as classes construídas pelo Departamento de Trabalho dos EUA [@onet].

Nosso objetivo é responder algumas questões com relação à taxa de aumento (ou diminuição) de tipos de trabalhos classificados pelo grau de automação de cada posição. Especificamente, apresentamos qual zona de trabalho apresenta o maior aumento e menor decréscimo no número de posições no Brasil, também utilizando o Sistema de Informações Geográficas (SIG) estudamos essa evolução no espaço localizando aglomerados espaciais de aumento e diminuição dessas posições no Brasil. microrregiões.

<!-- --- -->

<center style="padding-top:55px">
## 2. Referências 
</center>

O estudo sobre automação e digitalização e como esses cenários podem afetar os empregos em todo o mundo é continuamente atualizado ano a ano. Esta declaração está de acordo com o que foi dito por @raj2018ai. @raj2018ai afirma que o atual corpo de literatura empírica em torno da robótica e adoção de Machine Learning pelas organizações está crescendo e muitas vezes tentando responder a perguntas semelhantes: Será que a automação será o fim do trabalho tradicional? Algumas discrepâncias, no entanto, foram encontradas em vários estudos e essas discrepâncias evidenciam a necessidade de novas investigações, artigos de replicação e dados mais completos e detalhados.

Além disso, esses novos avanços tecnológicos levaram tanto à motivação sobre a capacidade dos algoritmos de Aprendizado de Máquina quanto à automação para impulsionar o crescimento econômico e também a preocupação com o destino dos trabalhadores humanos em um mundo no qual os algoritmos de computador podem executar muitas das funções humanas [@furman2016time]. Nesse sentido, @raj2018ai relatou que pesquisas acadêmicas recentes sugerem que automação e robótica podem ter sido responsáveis por cerca de um décimo do aumento do Produto Interno Bruto (PIB) dos EUA entre 1993 e 2007 [@graetz2017modern] mas também uma diminuição no número de postos de trabalho [@frey2017future].

@ramaswamy2018technological define automação quando uma máquina faz trabalho que poderia ter sido realizado anteriormente por uma pessoa, e hoje em dia, a maioria das tarefas manuais rotineiras, manuais não rotineiros e alguns tipos de tarefas rotineiras cognitivas e não rotineiras podem ser automatizados. @autor2003skill apresentou como a adoção rápida de tecnologias de computação altera as tarefas executadas pelos trabalhadores em seus trabalhos. Outra definição é dada por @chui2015four que avaliou o "automatismo" dessas capacidades através do uso de tecnologia atual de ponta, ajustando o nível de capacidade requerido para ocupações onde o trabalho ocorre em configurações imprevisíveis.

Os principais artigos sobre este tema relatados pela literatura científica são os trabalhos de @frey2013future e @frey2017future. @frey2017future estimou a suscetibilidade do emprego à informatização. Em seu artigo, os autores classificam as ocupações nos EUA com relação ao risco de serem suscetíveis à automação, perguntando aos especialistas sobre o potencial tecnológico de automação em um futuro próximo e aplicando um Classificador de Processo Gaussiano para 702 ocupações. Isso foi realizado através da classificação a priori, de algumas ocupações rotuladas por especialistas e a extrapolação da probabilidade para todos os dados. Como resultado, @frey2017future relatou que 47% de todas as pessoas empregadas nos EUA estão trabalhando em trabalhos que poderiam ser executados por computadores nos próximos 10 a 20 anos.

Uma ideia semelhante à proposta por @frey2017future foi aplicada a outros países. @pajarinen2014computerization sugere que 35,7% dos empregos na Finlândia estão sob alto risco para automação, @diba2015roboter estima que a parcela de empregos sob risco de automação chegue a 59% na Alemanha, @bowles2014computerisation encontra que a parcela de postos de trabalho que são suscetíveis à automação na Europa varia entre 45% à mais de 60% e @arntz2016risk estimou a automatização do trabalho dos 21 países da Organização para Cooperação e Desenvolvimento Econômico (OCDE).

Em nossa perspectiva, o mais abrangente o trabalho sobre o tema é devido a @arntz2016risk. Em seu artigo, os autores levam em conta a heterogeneidade das tarefas dos trabalhadores nas ocupações e descobriram que, em média, nos 21 países da OCDE, 9% dos empregos são automatizáveis. No entanto, os autores encontraram heterogeneidade entre os países da OCDE e destacaram que, enquanto a parcela de empregos automatizáveis é 6% na Coréia, a participação correspondente é de 12% na Áustria, essa diferença de acordo com os autores pode ser um reflexo das diferenças gerais das organizações de trabalho, ou devido ao nível educacional desses trabalhadores em todos os países. @arntz2016risk de fato não estudou o Brasil, o qual não é mebro da OCDE. Dessa forma, há a possibilidade de atender a uma lacuna nesse campo de estudo usando dados nacionais.

@arntz2016risk também constatou que, apesar das diferenças, a principal característica de todos os países da OCDE é que a capacidade de automação frequentemente diminui com o nível de educação bem como a renda dos trabalhadores. Para todos os tipos de empregados, @arntz2016risk sugerem que os indivíduos de baixa qualificação e renda são os que enfrentam um maior risco de terem seus postos de trabalho automatizáveis, este resultado é concordante com os achados @bakhshi2015creativity. 

@goos2014explaining e @david2013growth descobriram que nos EUA e na Europa tem sido a "polarização" do emprego por nível de habilidade a principal causa da desigualdade na renda salarial entre todos os tipos de ocupações.

@acemoglu2017robots examinam o impacto do aumento da automação industrial nos mercados de trabalho dos EUA entre 1990 e 2007. Os autores descobriram que a automação nos Estados Unidos está negativamente correlacionada com emprego e salários durante 1990 e 2007. @acemoglu2017robots também estimaram que cada máquina adicional reduziu o emprego em seis trabalhadores e que um novo robô por mil trabalhadores reduziu os salários em 0,5%. Este efeito, de acordo com os autores, é mais pronunciado na manufatura, particularmente em ocupações manuais e manuais de rotina (tarefas rotineiras cognitivas) e para trabalhadores sem diploma universitário.

Na mesma direção, @bessen2018ai afirma que no setor de manufatura, a tecnologia reduziu drasticamente os empregos nas últimas décadas. O autor apresentou um modelo de demanda o qual previa a ascensão e queda do emprego nas indústrias têxtil, siderúrgica e automobilística. Estes setores eram os mais vulneráveis no que diz respeito à automatização. 

@furman2018should, por exemplo, argumenta que apesar da tecnologia gerar novas demandas de consumo e consequentemente novos empregos, a rotatividade causada pela automação poderia levar a períodos de alto desemprego. Isto pode ser fatal para a economia dos países.

@ramaswamy2018technological resume a maioria das descobertas deste tema:

1. O aumento da automação e adoção de robôs não parece causar perda de emprego no conjunto de textos sobre o tema.

2. Trabalhadores pouco qualificados em trabalhos de rotina são mais propensos a sofrer demissões devido a automação de suas tarefas. Em que, os trabalhadores pouco qualificados são aqueles que realizam tarefas orientadas por processos de entrada simples com pouco pensamento abstrato.

3. Haverá demanda por novos tipos de trabalhadores qualificados ou novas especializações dentro de ocupações, e trabalhadores de alta habilidade que sejam capazes de realizar tarefas complicadas que requerem experiência, especialização, pensamento abstrato e autonomia.


@ramaswamy2018technological argumenta que o risco de automação de trabalho em países em desenvolvimento varia entre países, por exemplo, o autor afirma que é estimado para variar de 55% no Uzbequistão até 85% na Etiópia. Nas economias emergentes, estima-se que o risco de automação seja relativamente alto, com 77% de empregos na China e 69% na Índia considerados em risco. 

Enquanto a maioria dos estudos utilizou a descrição das ocupações e algumas opiniões de especialistas, @mann2017benign adotou uma abordagem diferente para analisar os efeitos da automação no emprego. Em seu estudo, os autores utilizaram em informações fornecidas por patentes concedidas. @mann2017benign aplicou um algoritmo classificador de Aprendizado de Máquina a todas as 5 milhões de patentes concedidas entre 1976 e 2014 para identificar patentes relacionadas à automação com base em uma amostra de 560 patentes classificadas manualmente para classificar patentes em inovações de automação e não-automação. @mann2017benign concluiram que, embora a automação reduza o emprego industrial, aumenta o emprego no setor de serviços e, em geral, tem um impacto positivo no emprego. Na mesma direção, @susskind2017model argumenta que o número de tarefas que os robôs podem substituir pode ser ainda muito maior.


Outro trabalho que apresenta uma visão geral otimista do tema é o artigo de @bessen2017automation. O autor descobriu que as novas tecnologias devem ter um efeito positivo no emprego, se melhorarem a produtividade em mercados onde há uma grande quantidade de demanda reprimida. Ele também sugere que a nova tecnologia de computadores está associada a declínios de emprego na indústria, onde a demanda é geralmente alcançada, mas está correlacionada com o crescimento do emprego em indústrias menos saturadas e não-manufatureiras. 

Outro trabalho que apresenta uma visão otimista do tema é o artigo de @bessen2017automation. Segundo o autor, as novas tecnologias devem ter um efeito positivo sobre o emprego se melhorarem a produtividade em mercados onde há uma grande quantidade de demanda reprimida. Também é sugerido que a nova tecnologia está associada ao declínio do emprego na indústria manufaturada, onde a demanda está correlacionada ao crescimento do emprego em indústrias menos saturadas e não manufatureiras.

De acordo com @furman2018should, uma vez que a automatização pode reduzir o número de postos de trabalho para os empregos menos qualificados, isso também pode implicar em um declínio da demanda por empregos mais qualificados. Por outro lado, tarefas mais qualificadas que usam capacidades de resolução de problemas, criatividade e intuição (tarefas cognitivas não-rotineiras), assim como tarefas de baixa qualificação que exigem adaptabilidade situacional e interações pessoais (cognitiva de rotina), são menos propensas a serem automatizados.

Com relação à revisão de literatura, podemos observar que cenários otimistas e pessimistas são possíveis. Se assumirmos que as máquinas só podem ser substitutas de tarefas de rotina [@acemoglu2011skills], então o resultado provavelmente será otimista ou menos pessimista. Isto é explicado por @acemoglu2016race, que argumenta que isto é devido a duas razões: primeiro, porque sempre haverá classes de ocupações que não serão totalmente automatizadas, e segundo, sempre é possível a introdução de novas tarefas em que o trabalho tem uma vantagem comparativa, como apontado por @acemoglu2016race. Isto pode compensar a perda de ocupações devido à automação.

Nenhum dos artigos citados estudou o Brasil e o impacto de uma crise econômica no número de postos de trabalho classificados pelo nível de complexidade ou probabilidade de automatização. Assim, propusemo-nos a estimar a probabilidade de automação da Classificação Brasileira de Ocupações - CBO, associando essa probabilidade com a classificação de zonas de trabalho (*Job Zones*) do O\*NET. Também é medido o efeito da crise econômica brasileira de 2015-2018 no número de postos de trabalho para os cinco *Job Zones* definidos pelo sistema de classificação O\*NET.

<center style="padding-top:55px">
## 3. Metodologia 
</center>

A base de dados utilizada nesse estudo foi a <i>Relação Anual de Informações Sociais</i> - RAIS. A RAIS é uma base de dados administrativa de periodicidade anual que tem por objetivo fornecer informações para entidades governamentais com o intuito de subsidiar políticas públicas do mercado de trabalho no Brasil.

A RAIS é um painel que cobre 97% dos trabalhadores formais no Brasil entre os anos de 1986 e 2016 e contêm outros dados como renda, nível educacional dos trabalhadores, idade, CBO, identificação da firma e <i>Classificação Nacional de Atividades Econômicas</i> - CNAE das firmas além de muitas outras variáveis regionais.

Com base nesses dados, o primeiro passo do estudo foi unificar a classificação O\*NET Job Zone com a RAIS para cada CBO. O O\*NET é uma base de dados que apresenta 1122 grupos ocupacionais e fornece definições e conceitos para descrever os trabalhadores quanto as suas habilidades e competências além de nível educacional exigido, além de 5 níveis denominados <i>Job Zones</i> que classificam as ocupações quanto ao seu nível de preparo:

1. Job Zone 1 - ocupações que requerem pouca preparação.
2. Job Zone 2 - ocupações que requerem alguma preparação.
3. Job Zone 3 - ocupações que necessitam de um nível intermediário de preparo.
4. Job Zone 4 - ocupações que necessitam de uma considerável preparação.
5. Job Zone 5 - ocupações que exigem alto nível de preparo.

A ideia foi então utilizar a classificação <i>Job Zones</i> como uma <i>proxy</i> do nível de automação das CBOs ao longo dos anos utilizando para isso a RAIS. De fato, existe uma relação negativa entre a classificação <i>Job Zones</i> e a probabilidade de automação apresentada na base O*NET como aponta a Figura 1.




```{r fig1, fig.cap=fig$cap("fig2", "Probabilidade de informatização por Job Zone")}
pdf <- pdf_text("https://www.oxfordmartin.ox.ac.uk/downloads/academic/future-of-employment.pdf")
pdf <- paste0(pdf, collapse = " ")
pattern <- "Rank\\s+Probability(.)*Telemarketers"
extract <- regmatches(pdf, regexpr(pattern, pdf))
extract <- unlist(strsplit(extract, "\r\n"))
FO <- read.fwf(con <- textConnection(extract), widths = c(7, 13, 6, 9, 80))
close(con)

FO <- FO %>% filter(grepl(".\\d", V2)) %>%
  mutate(rank = as.numeric(gsub(" ", "", V1)),
         prob = as.numeric(gsub(" ", "", V2)),
         soc  = as.character(gsub(" ", "",V4)),
         ocup = as.character(V5)) %>% select(-(V1:V5))

Job_Zones <- readxl::read_excel("Data/All_Job_Zones.xlsx", 
                                skip = 3, col_types = "text") %>% 
  mutate(Code = substr(Code,1,7)) %>% 
  rename(Job_Zone = `Job Zone`) %>% distinct(Job_Zone, Code) 

che <- Job_Zones %>% group_by(Code) %>% summarise(freq = n())

Job_Zones <- Job_Zones %>% filter(Code %in% filter(che, freq==1)$Code )

Comp <- full_join(FO, Job_Zones, by = c("soc" = "Code"))
Comp <- Comp %>% na.omit()

a <- ggplot(aes(y = prob, x = Job_Zone), data = Comp) + geom_boxplot(fill = "gray") +
  theme_bw() + labs(x = "Job Zone", y = "Probabilidade de automação") +
  theme(text = element_text(size=15))

ggplotly(a)%>% config(displayModeBar = F)

```

A Figura 1 apresenta a probabilidade de automação das ocupações segundo <i>Job Zones</i>. As probabilidades foram obtidas por meio do texto seminal @frey2017future que inspirou esse trabalho, e a correspondência foi dada por meio da classificação padrão de 2010 americana (<i> 2010 Standard Occupational Classification</i>), denominada SOC. Baseado na Figura 1 podemos notar que quanto mais complexo é uma ocupação em termos de nível de preparo, menor é a probabilidade de automação dessas ocupações.

Isso parece aderente com a hipótese de que as ocupações que necessitam de um nível elevado de preparo são mais difíceis de serem automatizadas pois há muitos detalhes na execução das tarefas correspondentes a essas ocupações o que restringe, pelo menos no curto prazo, a chance dessas ocupações serem automatizadas.

Uma vez que não há nenhuma tabela de conversão correspondente entre as CBOs nacionais e a <i>Job Zones</i> fornecida pelo O*NET nós atribuímos as <i>Job Zones</i> nas ocupações brasileiras por meio dos seguintes passos: usando a versão mais recente das CBOs datada de 2002 cuja fonte é @MTE, cruzamos esse dado com a <i>International Standard Classification of Occupations - @ISCO, version 88</i>. Esse cruzamento permitiu ligar os dados diretamente aos obtidos de @MTE.

Uma vez unificados esses dados nós atualizamos a ISCO-88 para a ISCO-08 e então foi possível relacionar a <i>2008 International Standard Classification of Occupations</i> com a @SOC de 2010. Finalmente, @ONET_ fornece a correspondência entre as Job Zones e a SOC 2010.

Após esse processo encontramos as <i>Job Zones</i> para 73% das CBOs, mas enquanto a base O*NET fornece 1122 grupos ocupacionais a RAIS (utilizando CBO de 2002) fornece 2602 grupos ocupacionais, assim, a correspondência entre essas duas fontes resulta em um base de dados final para a qual algumas ocupações CBO apresentam mais de uma correspondência com a <i>Job Zones</i>. 

Para as CBOs restantes nós preenchemos 8% dos códigos ocupacionais usando a tradução direta do inglês para o português da descrição dessas ocupações e fizemos a unificação por meio da medida de similaridade entre esses dois textos. A medida de similaridade expressa entre $[0, 1]$ e é dada por duas vezes a razão entre o número de elementos comuns entre os dois textos sobre o número total de palavras dos dois textos. Finalmente, os 19% restantes foram preenchidos por meio de inspeção manual realizada pelos autores desse trabalho, avaliando qual o nível de preparação é exigido para cada código ocupacional baseado na sua descrição de atividades.

Em seguida nós calculamos o número de trabalhadores esperado em cada <i>Job Zones</i> por ano. Matematicamente, seja $W_{i,t}$ o número de trabalhadores na $i$-ésima CBO, $t$ representa o índice de ano e $\pi_{i,j,t}$ o percentual de vezes que a $i$-ésima no período de tempo $t$ foi classificada como sendo oriunda de uma <i>Job Zones</i> $j$, assim o número esperado de trabalhadores por <i>Job Zones</i> e ano é dado por:

$$E_{j,t} = W_{i,t} \pi_{i,j,t} $$


\noindent para $j=1,\dots,5$. Entretanto, uma vez que o número de empregados por <i>Job Zones</i> é muito diferente em termos absolutos (pois há muito mais trabalhadores cujas ocupações necessitam de pouco preparo do que ocupações que necessitam de um alto nível de preparo), nós escolhemos trabalhar com a Taxa Acumulada de Crescimento (<i>Cumulative Growth Rate</i> - CGR) para que possa ser possível comparar as magnitudes de crescimento (ou decréscimo) dessas ocupações ao longo do tempo, especificamente a Taxa Acumulada de Crescimento foi calculada da seguinte forma: 

$$G_{j,t} = \displaystyle\sum_{t_{0}=1}^{t}\left[\frac{E_{j,t_{0}}}{E_{j,t_{0}-1}}-E_{j,t_{0}-1}\right]$$


\noindent onde $t_{0}=1$ o segundo ano da nossa série temporal, qual seja o ano de 1988 é o ano base de comparação.

A Figura 2 apresenta a Taxa Acumulada de Crescimento do número de empregados para cada <i>Job Zones</i>, bem como a Taxa Acumulada de Crescimento do Produto Interno Bruto (PIB) brasileiro.



```{r fig2, fig.cap=fig$cap("fig1", "plotting example")}
jobzone_painel <- read.csv2("./Data/jobzone_painel.csv")

serie <- jobzone_painel %>% 
  group_by(ano,Job_Zone) %>% 
  summarise(empreg = sum(empregados)) %>%
  na.omit()

graph01.tbl2 <- serie %>%
  group_by(Job_Zone) %>%
  mutate(lag = lag(empreg)) %>%
  mutate(pct.change = (empreg - lag) / lag) %>% 
  na.omit()

graph01.tbl <- graph01.tbl2 %>%
  group_by(Job_Zone) %>%
  mutate(cumulative= cumprod(1 + pct.change) - 1) %>% 
  rename(year = ano)

graph01.tbl <- graph01.tbl %>%
  ungroup() %>% 
  mutate(Job_Zone = as.character(Job_Zone))



GDP_GROWTH <- read_excel("Data/GDP_GROWTH.xls", skip = 3)
GDP_GROWTH <- GDP_GROWTH %>% filter(`Country Name` == "Brazil") %>% gather(year, growth) %>%
  filter(year %in% 1986:2016) %>% mutate(growth     = as.numeric(growth),
                                         cumulative = (cumprod(growth/100 + 1) - 1))

GDP_GROWTH2<-GDP_GROWTH %>% 
  mutate(Job_Zone="GDP",
         year = as.numeric(year)) %>% 
  select(-growth)


final<-bind_rows(graph01.tbl,GDP_GROWTH2)
final<-subset(final,year>1986)

mycolors <- RColorBrewer::brewer.pal(5, "Pastel1")
mycolors<-c(mycolors, "#000000")

g <- final %>% mutate(cumulative = round(cumulative,2)) %>% 
  select(year, Job_Zone, cumulative) %>% spread(Job_Zone, cumulative)

p <- plot_ly(g, x=~year, y=~`1`, name = "Job Zone 1", marker=list(color=mycolors[1]), 
             line=list(color=mycolors[1]),type = 'scatter', mode = 'lines+markers') %>% 
  add_trace(y = ~`2`, name = "Job Zone 2", marker=list(color=mycolors[2]), line=list(color=mycolors[2])) %>% 
  add_trace(y = ~`3`, name = "Job Zone 3", marker=list(color=mycolors[3]), line=list(color=mycolors[3])) %>% 
  add_trace(y = ~`4`, name = "Job Zone 4", marker=list(color=mycolors[4]), line=list(color=mycolors[4]))%>% 
  add_trace(y = ~`5`, name = "Job Zone 5", marker=list(color=mycolors[5]), line=list(color=mycolors[5]))%>% 
  add_trace(y = ~GDP, name = "PIB Acumulado", marker=list(color =mycolors[6]), line = list(color =mycolors[6])) %>%
  layout( legend = list(orientation = 'h',xanchor = "center", x = 0.5), xaxis = list(title = " "),
          yaxis = list(title = "Taxa de Crescimento Acumulado"), hovermode = "compare")%>%
  config(displayModeBar = F)

p
```

Se nós acreditarmos que a automação de fato está eliminando postos de trabalho ao longo dos anos, especialmente para as primeiras <i>Job Zones</i>, deveríamos observar que a curva da Taxa Acumulada de Crescimento Acumulada da quinta <i>Job Zone</i> deveria superar a curva da <i>Job Zones</i> 4, seguida pela <i>Job Zones</i> 3, <i>Job Zones</i> 2 e finalmente <i>Job Zones</i> 1. Mas de maneira interessante esse padrão não é representado na Figura 2. 

Na verdade o que observa-se é que os postos de trabalho formais da primeira <i>Job Zone</i> superou as <i>Job Zones</i> 5,4,3 e 2 nessa ordem. A primeira questão que surge é por quê a taxa de trabalhadores da <i>Job Zone</i> 1 cresceu mais nos últimos anos do que a taxa de trabalhadores nas demais <i>Job Zones</i>, se esta é a que necessita de menor nível de preparo do que as demais. Algumas possibilidades podem ser apresentadas: a primeira assume-se que a automação das ocupações não esteja acontecendo no Brasil, isso explicaria o porquê das curvas na Figura 2 não seguirem a ordem 5,4,3,2 e 1 em suas taxas de crescimento acumulado, mas não explica o motivo das <i>Job Zones</i> 5,4,3 e 2 se comportarem como previsto.

A segunda alternativa e mais plausível é a possibilidade dos trabalhadores das <i>Job Zones</i> 2, 3, 4 e até mesmo 5 terem perdido seus empregos nos últimos anos devido a automação e questões macroeconômicas e então foram realocados no mercado de trabalho em <i>Job Zones</i> inferiores a sua <i>Job Zone</i> original. 

Caso essa alternativa seja a correta algo preocupante deve ser analisado mais profundamente: o que acontecerá com esses trabalhadores de <i>Job Zones</i> inferiores caso suas ocupações sejam automatizadas? E de fato, quanto menor o nível da <i>Job Zone</i>, menos preparo o profissional precisa ter e maior a chance de suas tarefas serem automatizadas. Isso alinhado com o baixo custo de automação, o fato de os robôs não necessitarem de direitos trabalhistas e poderem operar 24 horas por dia deixa muito competitiva a alternativa de automação <i>versus</i>o trabalho humano manual, podendo assim eliminar potencialmente muitas vagas de trabalho em um futuro próximo.

Para confirmar essa hipótese nós acompanhamos os trabalhadores ao longo do tempo e medimos o número de vezes em que eles mudaram de <i>Job Zone</i> ao longo dos anos, valores esses representados pela Tabela 1:


```{r tab1}
tab1 <- readr::read_delim("Paper_HTML/Tables/table1.txt", delim = "&")
tab1 <- tab1 %>% mutate_at(-1, as.numeric)

kable(tab1, caption = " ", format.args = list(decimal.mark = ","),booktabs=TRUE)
```

<center style="padding-bottom:20px;">Tabela 1: Percentual de mudanças para a <i>Job Zone</i> 1 ao longo dos anos.</center>

Por meio da Tabela 2 podemos observar que o percentual de mudança para a <i>Job Zone</i> 1 é maior entre os trabalhadores da <i>Job Zone</i> 2, seguido pela <i>Job Zone</i> 3, <i>Job Zone</i> 4 e com menor frequência os trabalhadores da <i>Job Zone</i> 5. Esses dados corroboram para a hipótese de migração para <i>Job Zones</i> inferiores como uma alternativa que os trabalhadores têm quando perdem seus empregos. Segundo essa hipótese é preferível receber menos em uma ocupação de baixo nível preparatório (mesmo que o trabalhador originalmente possua elevado nível de preparação) do que não estar atuando no mercado de trabalho.

Outra questão que surge é: o decréscimo na taxa no PIB devido a crise financeira brasileira afeta de maneira igual a redução dos postos de trabalho para todas as <i>Job Zones</i> ?

Essa questão é motivada pela recente crise financeira brasileira que foi seguida de uma crise política resultando no impeachment da presidente Dilma Rousseff aliada com a insatisfação popular com o sistema político nacional.

Após 2014 o PIB brasileiro caiu em 3.9% devido a perdas salariais, restrições de crédito, aumento da taxa de juros básica e o elevado desemprego em todos os setores da economia. Essa diminuição pode ser observada na Figura 2 onde a Taxa de Crescimento Acumulada dos empregados nas <i>Job Zones</i> também caiu a partir de 2014:


```{r tab2}
tab2 <-  readr::read_delim(
"Job Zone & Percentual
Level 1  & 31,4475%
Level 2  & 17,9420%
Level 3  & 14,4177%
Level 4  & 16,0446%
Level 5  & 7,5201%", delim = "&")

kable(tab2, caption = " ")
```

<center style="padding-bottom:20px;">Tabela 2: Percentual de redução entre 2014 to 2016 na Taxa de Cresimento Acumulada.</center>

A Tabela 2 mostra que o percentual decresce em uma magnitude muito maior para os trabalhadores da <i>Job Zone</i>, face a uma redução do PIB do que as demais <i>Job Zones</i>. De igual modo, quanto maior o nível de preparo menor é essa redução nos postos de trabalho quando da existência de uma crise financeira.


### 3.1. Pesquisa sobre automação de empregos

Usando uma ideia similar a proposta por @frey2017future nós coletamos na plataforma Lattes do Conselho Nacional de Desenvolvimento Científico e Tecnológico (CNPq) o nome de todos os pesquisadores cadastrados na plataforma e que tenham atuado em projetos de automação relacionados ao Aprendizado de Máquina.

Durante esse processo encontramos 754 e-mails de profissionais que reportaram na Plataforma Lattes do CNPq sua atuação em projetos de automação. É de se esperar que esses profissionais por sua atuação acadêmica em projetos de automação possuam capacidade de classificar as ocupações brasileiras segunda a sua probabilidade de automação.

Convidamos então todos esses pesquisadores para avaliar, de maneira aleatória, CBOs quanto a sua probabilidade de automação. Era fornecido, portanto para os pesquisadores o nome da CBO, a descrição das atividades realizadas por essa ocupação e o respondente atribuía uma probabilidade entre 0 e 1 do nível de automação dessas ocupações.

A base de dados final com todas as respostas registrou 3966 respostas de 69 pesquisadores e 2046 CBOs em uma população de 2602 CBOs existentes. Observamos ainda que cada respondente avaliou em média 57,48 CBOs aleatórias durante o processo de coleta dos dados.

A distribuição das respostas por campos de pesquisa é apresentada pela Tabela 3:


```{r tab3}
tab3 <-  readr::read_delim(
"Campo           & Respostas & Pesquisadores
Ciências Aplicadas  & 3489    & 58
Interdisciplinar & 29      & 2 
Negócio          & 228     & 2 
Ciências Naturais & 220     & 7 ", delim = "&")


kable(tab3, caption = " ")
```

<center style="padding-bottom:20px;">Tabela 3: Campos de atuação dos respondentes da pesquisa.</center>

Em seguida, para se estimar a probabilidade final de automação das CBOs usando a amostra coletada, geramos a frequência de palavras (unigramas e bigramas) que descreviam cada CBO observada na amostra utilizando para isso as descrições de atividades dessas ocupações.

Esses unigramas e bigramas foram obtidos após a remoção de <i>stop-words</i>, números, abreviações e pontuação totalizando mais de 19 mil variáveis. Por se tratar de uma quantidade extensa de características que descreveriam as ocupações procedeu-se com uma Análise de Componentes Principais como forma de redução das características observadas. Mantendo-se pelo menos 70% de variabilidade explicada selecionamos os primeiros 372 componentes principais.

O último passo foi o cômputo da probabilidade de automação para todas as CBOs, para isso usamos a amostra coletada e as características sumarizadas pelos componentes principais para terinar e avaliar um modelo de Processo Gaussiano com <i>Automatic Relevance Determination (ARD)</i> com o intuito de regularizar o modelo e apresentar estimativas mais robustas para o nível de automação.

Seja $\mathbf{x}_{i}$ e $\mathbf{x}_{j}$duas observações $i,j=1,\dots, 3801$ e $\mathbf{x}_{i},\mathbf{x}_{j}\in \mathbb{R}^{P}$ with $P=372$, o ARD foi ajustado considerando-se a seguinte função <i>kernel</i>:

$$K(\mathbf{x}_{i},\mathbf{x}_{j})_{\boldsymbol\theta}=\sigma_{f}^{2}\exp\left[-\frac{1}{2}\displaystyle\sum_{p=1}^{P}\left(\frac{x_{ip}-x_{jp}}{\lambda_{p}}\right)^{2}\right]$$


\noindent onde $\boldsymbol\theta=(\sigma_{f}^{2},\sigma_{\epsilon}^{2},\lambda_{1},\dots,\lambda_{P})$. É importante notar que quando $\lambda_{p}\rightarrow \infty$ a função predita varia menos e menos em função de $x_{ip},x_{jp}$, isto é, a $p$-ésima dimensão se torna irrelevante para descrever e estimar a probabilidade de automação, de igual modo quando $\lambda_{p}\rightarrow 0$ a distância entre $x_{ip}$ e $x_{jp}$ é mais fortemente ponderada no processo gerador dos dados, representando assim que aquela característica possui elevada importância na estimação da probabilidade de automação.

Os hiperparâmetros $\boldsymbol\theta$ foram obtidos maximizando-se a verossimilhança marginal [@schulz2018tutorial]:

$$\log[p(\mathbf{y}|\mathbf{X},\boldsymbol\theta)]=-\frac{1}{2}\mathbf{y}^{\top}\mathbf{K}_{y}^{-1}\mathbf{y}-\frac{1}{2}\log|\mathbf{K}_{y}|-\frac{n}{2}\log(2\pi)$$

\noindent onde $\mathbf{K}_{y}=K(\mathbf{X},\mathbf{X})+\sigma_{\epsilon}^{2}\mathbf{I}$, $(\mathbf{y}$ é a probabilidade de automação registrada pelos respondentes na pesquisa, $\mathbf{X}$ é a matriz de características contendo os componentes principais obtidos dos unigramas e bigramas e $n=3801$ é o tamanho amostral.

Finalmente, usando a densidade <i>a posteriori</i> multivariada nós obtivemos as equações de predição para o processo gaussiano de regressão [@rasmussen2004gaussian]:

$$\mathbf{f}_{*}|\mathbf{X},\mathbf{y},\mathbf{X}_{*}\sim N(\overline{\mathbf{f}}_{*},Cov(\mathbf{f}_{*}))$$
\noindent onde $\overline{\mathbf{f}}_{*}=K(\mathbf{X}_{*},\mathbf{X})[K(\mathbf{X},\mathbf{X})+\sigma_{\epsilon}^{2}\mathbf{I}]^{-1}\mathbf{y}$ e $Cov(\mathbf{f}_{*})=K(\mathbf{X}_{*},\mathbf{X}_{*})-K(\mathbf{X}_{*},\mathbf{X})[K(\mathbf{X},\mathbf{X})+\sigma_{\epsilon}^{2}\mathbf{I}]^{-1}K(\mathbf{X},\mathbf{X}_{*})$ com $\mathbf{X}_{*}$ sendo a matriz com todos os componentes principais de todas as CBOs, incluindo as CBOs não observadas na amostra. 


<center style="padding-top:55px">
## 4. Resultados 
</center>

Simulando 5000 observações da Densidade \ref{eq:normal} nós obtivemos a estimativa empírica da distribuição de probabilidade de automação para cada CBO. É interessante notar nesse caso que a abordagem Bayesiana fornece uma interpretação útil para os resultados obtidos, uma vez que devido ao alto grau de incertezas seria melhor amostrar observações da distribuição <i>a posteriori</i> do parâmetro relativo a probabilidade de automação do que simplesmente fornecer uma única estimativa pontual.

Ademais, quanto maior a variabilidade desse parâmetro (calculado usando-se as amostras geradas da distribuição <i>a posteriori</i> da probabilidade de automação), maior seria a heterogeneidade entre os trabalhadores da referida CBO, em outras palavras, uma alta variabilidade representaria que há diversidade de atividades na ocupação alvo que podem ser facilmente automatizadas e outras dificilmente seriam automatizadas. Já uma baixa variabilidade nas amostras geradas pela distribuição <i>a posteriori</i> da probabilidade de automação representaria que esse grupo CBO é muito homogêneo internamente o possivelmente todos (ou a maioria) dos profissionais alocados nessa CBO podem ter suas atividades automatizadas (quando a mediana da probabilidade de automação for alta), ou que suas atividades não poderiam ser facilmente automatizadas (no caso da mediana da probabilidade de automação for baixa).

Nesse sentido nós definimos 5 níveis de automação com base nas medianas da distribuição <i>a posteriori</i> da probabilidade de automação gerada por meio do Processo Gaussiano, quais sejam:

1. Automação Muito Baixa - Mediana da probabilidade entre 0 e 0,2.
2. Automação Baixa - Mediana da probabilidade entre 0,2 e 0,4.
3. Automação Média - Mediana da probabilidade entre 0,4 e 0,6.
4. Automação Alta - Mediana da probabilidade entre 0,6 e 0,8.
5. Automação Muito Alta - Mediana da probabilidade entre 0,8 e 1,0.

Para estimar o total de empregos em risco nos próximos 30 anos procedeu-se com a estimação de um modelo <i>Autoregressive integrated moving average</i> - ARIMA para as séries temporais de cada CBO entre 1986 e 2016, interpolando linearmente qualquer ponto faltante nesses anos. As estimativas foram obtidas por meio da proposta de \cite{Hyndman}.

A Figura 3 apresenta o número total de empregados observados e preditos pelo modelo ARIMA entre 1986 e 2046:

```{r fig3, fig.cap=fig$cap("fig3", "Série temporal da ocupação por nível de automação."), message=FALSE, warning=FALSE}
library(tidyverse)
library(scales)
profile<-read.csv2("Data/Occupation Structure/CBO2002 - PerfilOcupacional.csv")
profile<-data.frame("cbo2002"=unique(profile[,5]))
#Read the results
results<-readRDS("Analysis/ProbabilityGP_round.rds")
forecast<-read.csv("shiny_portal/Previsao.csv")


#Remove strange CBO
serie<-inner_join(forecast,profile, by="cbo2002")

#Calculate the total
total.cbo <- forecast %>% 
  mutate(cbo2002 = factor(cbo2002)) %>% 
  group_by(cbo2002, ano) %>% 
  summarise(Total=sum(empregados)) 

#Calculate the median
median.cbo <- results %>% 
              group_by(COD_OCUPACAO) %>% 
              summarise(Probability=median(Probability))
colnames(median.cbo)<-c("cbo2002","Probability")

#Merge data
final <- inner_join(total.cbo, median.cbo, by = "cbo2002" )

#Create the classes
final$Class<-cut(final$Probability,breaks = c(0,0.2,0.4,0.6,0.8,1) ,labels = c("Muito Baixo","Baixo","Médio","Alto", "Muito Alto"))
final <- final %>% 
  group_by(Class, ano) %>% 
  summarise(Total=sum(Total))

g2 <- final %>% mutate(Total = round(Total,2)) %>% 
  select(ano, Class, Total) %>% spread(Class, Total)


#Colors
mycolors <- RColorBrewer::brewer.pal(5, "Pastel1")
mycolors<-c(mycolors,"#000000")

p1 <- plot_ly(g2, x=~ano, y=~`Muito Baixo`, name = "Muito Baixo", marker=list(color=mycolors[1]), 
             line=list(color=mycolors[1]),type = 'scatter', mode = 'lines+markers') %>% 
  add_trace(y = ~Baixo, name = "Baixo", marker=list(color=mycolors[2]), line=list(color=mycolors[2])) %>%
  add_trace(y = ~`Médio`, name = "Médio", marker=list(color=mycolors[3]), line=list(color=mycolors[3])) %>%
  add_trace(y = ~Alto, name = "Alto", marker=list(color=mycolors[4]), line=list(color=mycolors[4]))%>%
  add_trace(y = ~`Muito Alto`, name = "Muito Alto", marker=list(color=mycolors[5]), line=list(color=mycolors[5]))%>%
  layout( legend = list(orientation = 'h', xanchor = "center", x = 0.5), xaxis = list(title = " "),
          yaxis = list(title = "Número de Empregados"), hovermode = "compare") %>%
  config(displayModeBar = F)
p1
```

Após 2016 os dados apresentados na Figura 3 são estimativas de previsão baseadas nas tendências observadas das séries temporais do número total de empregados para cada CBO. Podemos notar que o número de empregados para as CBOs caracterizadas como possuindo alto nível de automação aumenta ao longo dos anos, assumindo para isso que as tendências observadas no passado se mantenham.

Assim, dois cenários surgem: o primeiro é que as firmas no Brasil mantêm o seu mesmo padrão de contratação independentemente do nível de automação, isto é, as empresas em sua maioria prefeririam manter trabalhadores humanos a automação de tarefas, e devido a essa demanda de empregados a previsão para o número total de pessoas empregadas nesses grupos aumentaria.

Já o segundo cenário é mais preocupante. Caso as empresas decidam por automatizar essas profissões com alta chance de automação então aproximadamente 30 milhões de empregos estariam em risco até 2026. Esse cenário é o mais fidedigno, uma vez que a automação de tarefas para as firmas produziria um aumento na eficiência de seus processos, redução de custos além da possibilidade de certas atividades serem executadas 24 horas 7 dias por semana.

O desafio enfrentado pelo governo Brasileiro em um futuro próximo está em lidar com esse cenário garantindo treinamento suficiente para os trabalhadores (em especial os trabalhadores pouco qualificados) para atuar em outros ramos de atividades cujo o nível de automação seja menor.

Além do mais, mesmo que uma quantidade suficiente de trabalhadores qualificados esteja disponíveis, as firmas decidem em investir em novas tecnologias dependendo do fator relativo dos preços do capital e do trabalho na realização de uma determinada tarefa no processo de produção. 




@arntz2016risk However, low qualified workers are likely to bear the brunt of the adjustment costs as the automatibility of their jobs is higher compared to highly qualified workers. Therefore, the likely challenge for the future lies in coping with rising inequality and ensuring sufficient (re-)training especially for low qualified workers. However, education plays a large role for many countries. In most countries, the within-education component is negative, which implies that people with the same education typically perform less automatable tasks compared to the US. However, in many countries the between-education component is positive, which implies that in those countries a larger share of workers has educational levels which are associated with more automatable tasks (i.e. low or medium qualified workers).

Furthermore, even if sufficiently qualified personnel were available, firms decide on investing in new technologies depending on the relative factor prices of capital and labour in performing a certain task in the production process.

@graetz2017modern discuss recession and automazation.

<font color="red"> @bessen2018ai

Of course, job losses in one industry might be offset by employment growth in other industries. (**Explicação para as Job Zones intermediárias serem jogadas na primeira**)

</font>



## Referências Bibliográficas
<div id="refs"></div>



## Afiliação

</div>


```{r save}
saveRDS(Comp, "Box_Paper.RDS")
saveRDS(g, "Serie_Paper.RDS")
saveRDS(g2, "Serie_Paper2.RDS")
```

